######################################
###        Training parameters     ###

defaults:
  - _self_
  - loss: focal # loss in (bce, combined, cross_entropy, dice, focal, lovasz)
  - model: siamese_fused # model in (baseline, siamese, siamese_fused)
  - scheduler: step_lr # scheduler in (step_lr)
  - logger: neptune # logger in (csv, neptune)

load_from_checkpoint: false
checkpoint_path: ${oc.env:CHECKPOINT_PATH, ""}

# each epoch training time on RTX4090:
# [siamese, siamese_fused] 2 minutes
# [baseline] 4 minutes
# if distance_transform then training time multiply by 2
max_epochs: 60
learning_rate: 0.0001
weight_decay: 0.00001
batch_size: 1

# number of pictures = if augment disable then 1 otherwise color * spatial, where
# color = color.n_transforms+1 if color.enabled else 1
# spatial = 8 if spatial.enabled else 1
augment:
  enabled: true
  color:
    enabled: true
    n_transforms: 4 # should be greater than 0
    brightness: 0.15
    contrast: 0.15
    saturation: 20
    hue: 20
  spatial: # always n_transforms = 8
    enabled: true

# distance transform (param not supported and ignored by baseline)
distance_transform:
  enabled: true

# flood classification (param not supported and ignored by baseline)
flood_classification:  # classification flooded/non-flooded
  enabled: true
  initial_weight: 0.01
  max_weight: 0.25
  increase_factor: 2
  increase_every_n_epochs: 3

save_images_on_disk: true
save_images_on_disk_count: 122
visualize_blending_color: true

######################################
### Below are technical parameters ###

project_dir: ${oc.env:GSN_SN8_DIR}
train_csv: ${project_dir}/inputs/sn8_data_train.csv
val_csv: ${project_dir}/inputs/sn8_data_val.csv

hydra:
  run:
    dir: ${project_dir}/outputs/gsn/${hydra.job.name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
  sweep:
    dir: ${project_dir}/outputs/gsn/${hydra.job.name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
output_dir: ${hydra:runtime.output_dir}
checkpoints_dir: ${hydra:runtime.output_dir}/checkpoints